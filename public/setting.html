<!DOCTYPE html>
<html lang="mr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Settings - Smart Sheti</title>

<style>
:root {
    --green-main: #2e7d32;
    --bg-body: #f0f2f5;
    --card-bg: #ffffff;
    --text-color: #333;
    --input-bg: #eeeeee;
}

body.dark-theme {
    --bg-body: #121212;
    --card-bg: #1e1e1e;
    --text-color: #ffffff;
    --input-bg: #333333;
}

body {
    font-family: 'Segoe UI', sans-serif;
    background-color: var(--bg-body);
    color: var(--text-color);
    margin: 0;
    transition: 0.3s;
}

.header {
    background-color: var(--green-main);
    color: white;
    padding: 15px;
    display: flex;
    align-items: center;
    font-size: 20px;
    font-weight: bold;
}

.back-btn {
    margin-right: 15px;
    text-decoration: none;
    color: white;
}

.container { padding: 15px; }

.card {
    background-color: var(--card-bg);
    border-radius: 20px;
    padding: 20px;
    margin-bottom: 20px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.05);
    text-align: center;
}

.profile-section {
    position: relative;
    display: inline-block;
}

.avatar {
    width: 130px;
    height: 130px;
    border-radius: 50%;
    border: 3px solid var(--green-main);
    object-fit: cover;
}

.cam-icon {
    position: absolute;
    bottom: 5px;
    right: 5px;
    background: var(--green-main);
    color: white;
    width: 35px;
    height: 35px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    border: 2px solid white;
}

input, select {
    width: 100%;
            background-color: var(--input-bg);
            border: 1px solid #ddd;
            border-radius: 12px;
            padding: 12px;
            margin: 10px 0;
            font-size: 16px;
            color: var(--text-color);
            box-sizing: border-box;
        }

.label-group { text-align: left; margin-bottom: 15px; }
.label-text { font-weight: bold; }

.btn {
    width: 100%;
    padding: 14px;
    border-radius: 12px;
    border: none;
    font-size: 16px;
    font-weight: bold;
    margin-top: 5px;
}

.btn-edit { background: #555; color: white; }
.btn-save { background: var(--green-main); color: white; display: none; }
.btn-logout { background: #ff9800; color: white; }
.btn-delete { background: #f44336; color: white; }
</style>
</head>

<body>

<div class="header">
    <a href="home.html" class="back-btn">‚Üê</a>
    ‡§Ö‚Äç‡•Ö‡§™ ‡§∏‡•á‡§ü‡§ø‡§Ç‡§ó
</div>

<div class="container">

<div class="card">
    <div class="profile-section" onclick="fileInput.click()">
        <img id="profilePic" src="https://via.placeholder.com/150" class="avatar">
        <div class="cam-icon">üì∑</div>
    </div>

    <input type="file" id="fileInput" hidden accept="image/*">

    <input type="text" id="userNameInput" placeholder="‡§§‡•Å‡§Æ‡§ö‡§Ç ‡§®‡§æ‡§µ ‡§ü‡§æ‡§ï‡§æ" disabled>

    <button class="btn btn-edit" id="editBtn">‡§è‡§°‡§ø‡§ü (Edit)</button>
    <button class="btn btn-save" id="saveBtn">‡§∏‡•á‡§µ‡•ç‡§π (Save)</button>
</div>

<div class="card">
    <div class="label-group">
        <div class="label-text">üåê ‡§≠‡§æ‡§∑‡§æ</div>
        <select id="langSelect" onchange="changeLanguage(this.value)">
            <option value="mr">‡§Æ‡§∞‡§æ‡§†‡•Ä</option>
            <option value="hi">‡§π‡§ø‡§Ç‡§¶‡•Ä</option>
            <option value="en">English</option>
        </select>
    </div>

    <div class="label-group">
        <div class="label-text">üé® ‡§•‡•Ä‡§Æ</div>
        <select id="themeSelect" onchange="toggleTheme(this.value)">
            <option value="light">Light</option>
            <option value="dark">Dark</option>
        </select>
    </div>
</div>

<div class="card">
    <button class="btn btn-logout" id="logoutBtn">‡§¨‡§æ‡§π‡•á‡§∞ ‡§™‡§°‡§æ (Logout)</button>
    <button class="btn btn-delete" id="deleteBtn">‡§ñ‡§æ‡§§‡•á ‡§π‡§ü‡§µ‡§æ (Delete)</button>
</div>

</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getAuth, signOut, deleteUser, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";

const firebaseConfig = {
  apiKey: "AIzaSyA1M7dJ9KFVe1GAGWPPqLuAT7BEuIKsZkM",
  authDomain: "smart-sheti-6512e.firebaseapp.com",
  projectId: "smart-sheti-6512e",
  storageBucket: "smart-sheti-6512e.firebasestorage.app",
  messagingSenderId: "1086459599128",
  appId: "1:1086459599128:web:03a34ed9ea2b95b1ebe66d"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);

/* LOAD */
window.onload = () => {
    const theme = localStorage.getItem("appTheme") || "light";
    themeSelect.value = theme;
    if (theme === "dark") document.body.classList.add("dark-theme");

    langSelect.value = localStorage.getItem("appLang") || "mr";

    const img = localStorage.getItem("userPhoto");
    if (img) profilePic.src = img;

    userNameInput.value = localStorage.getItem("userName") || "";
};

/* EDIT */
editBtn.onclick = () => {
    userNameInput.disabled = false;
    userNameInput.focus();
    editBtn.style.display = "none";
    saveBtn.style.display = "block";
};

/* SAVE */
saveBtn.onclick = () => {
    if (!userNameInput.value.trim()) {
        alert("‡§®‡§æ‡§µ ‡§ü‡§æ‡§ï‡§æ");
        return;
    }
    localStorage.setItem("userName", userNameInput.value);
    userNameInput.disabled = true;
    saveBtn.style.display = "none";
    editBtn.style.display = "block";
    alert("‡§Æ‡§æ‡§π‡§ø‡§§‡•Ä ‡§∏‡§æ‡§†‡§µ‡§≤‡•Ä ‚úÖ");
};

/* PHOTO */
fileInput.onchange = e => {
    const r = new FileReader();
    r.onload = () => {
        localStorage.setItem("userPhoto", r.result);
        profilePic.src = r.result;
    };
    r.readAsDataURL(e.target.files[0]);
};

/* THEME */
window.toggleTheme = val => {
    localStorage.setItem("appTheme", val);
    document.body.classList.toggle("dark-theme", val === "dark");
};

/* LANGUAGE */
window.changeLanguage = val => {
    localStorage.setItem("appLang", val);
    alert("‡§≠‡§æ‡§∑‡§æ ‡§¨‡§¶‡§≤‡§≤‡•Ä");
};

/* LOGOUT */
logoutBtn.onclick = () => {
    if (confirm("‡§≤‡•â‡§ó‡§Ü‡§â‡§ü ‡§ï‡§∞‡§æ‡§Ø‡§ö‡•á ‡§Ü‡§π‡•á ‡§ï‡§æ?")) {
        signOut(auth).then(() => location.replace("index.html"));
    }
};

/* DELETE */
deleteBtn.onclick = () => {
    onAuthStateChanged(auth, user => {
        if (user && confirm("‡§ñ‡§æ‡§§‡•á ‡§π‡§ü‡§µ‡§æ‡§Ø‡§ö‡•á ‡§Ü‡§π‡•á ‡§ï‡§æ?")) {
            deleteUser(user).then(() => location.replace("index.html"));
        }
    });
};
</script>

</body>
</html>
