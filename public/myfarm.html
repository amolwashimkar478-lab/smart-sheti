<!DOCTYPE html>
<html lang="mr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>рдорд╛рдЭрдВ рд╕реНрдорд╛рд░реНрдЯ рд╢реЗрдд</title>
    <style>
        body { font-family: 'Poppins', sans-serif; background-color: #f0f4f0; margin: 0; padding: 15px; }
        .card { max-width: 500px; margin: auto; background: white; padding: 25px; border-radius: 20px; box-shadow: 0 10px 25px rgba(0,0,0,0.1); }
        h2 { color: #2e7d32; text-align: center; margin-top: 0; }
        label { font-weight: bold; display: block; margin-top: 15px; color: #444; }
        select, input { width: 100%; padding: 12px; margin-top: 5px; border: 1.5px solid #ddd; border-radius: 10px; font-size: 16px; box-sizing: border-box; }
        .btn-start { width: 100%; margin-top: 25px; padding: 15px; background: #2e7d32; color: white; border: none; border-radius: 12px; font-size: 18px; font-weight: bold; cursor: pointer; }
        .btn-home { width: 100%; margin-top: 15px; padding: 15px; background: #2196F3; color: white; border: none; border-radius: 12px; font-size: 18px; font-weight: bold; cursor: pointer; text-decoration: none; display: block; text-align: center; box-sizing: border-box; }
        .btn-reset { background: #f44336; margin-top: 20px; font-size: 14px; padding: 10px; width: 100%; color: white; border: none; border-radius: 8px; cursor: pointer; }
        #adviceDisplay { display: none; margin-top: 20px; }
        .advice-box { background: #e8f5e9; padding: 20px; border-radius: 15px; border-left: 8px solid #2e7d32; }
    </style>
</head>
<body>

<div class="card">
    <h2>ЁЯЪЬ рд╕реНрдорд╛рд░реНрдЯ рд╕рд▓реНрд▓рд╛рдЧрд╛рд░</h2>

    <div id="setupForm">
        <label>рд╣рдВрдЧрд╛рдо рдирд┐рд╡рдбрд╛</label>
        <select id="seasonSelect" onchange="loadCrops()">
            <option value="">-- рдирд┐рд╡рдбрд╛ --</option>
            <option value="KHARIF">ЁЯМзя╕П рдЦрд░реАрдк</option>
            <option value="RABI">тЭДя╕П рд░рдмреНрдмреА</option>
            <option value="SUMMER">тШАя╕П рдЙрдиреНрд╣рд╛рд│реА</option>
            <option value="OTHER">ЁЯМ┐ рдЪрд╛рд░рд╛ рд╡ рдорд╕рд╛рд▓реЗ</option>
        </select>

        <label>рдкреАрдХ рдирд┐рд╡рдбрд╛</label>
        <select id="cropSelect">
            <option value="">рдЖрдзреА рд╣рдВрдЧрд╛рдо рдирд┐рд╡рдбрд╛</option>
        </select>

        <label>рд▓рд╛рдЧрд╡рдб рддрд╛рд░реАрдЦ</label>
        <input type="date" id="plantDate">

        <button class="btn-start" onclick="saveFarm()">ЁЯЪА рд╕рд▓реНрд▓рд╛ рд╕реБрд░реВ рдХрд░рд╛</button>
    </div>

    <div id="adviceDisplay">
        <div class="advice-box" id="adviceContent"></div>
        <button class="btn-home" onclick="location.href='home.html'">ЁЯПа рд╣реЛрдорд╡рд░ рдЬрд╛</button>
        <button class="btn-reset" onclick="resetData()">ЁЯФД рдорд╛рд╣рд┐рддреА рдмрджрд▓рд╛</button>
    </div>
</div>

<script>
// резреиреж+ рдкрд┐рдХрд╛рдВрдЪрд╛ рдорд╛рд╕реНрдЯрд░ рдбреЗрдЯрд╛ (рд╕рдВрдХреНрд╖рд┐рдкреНрдд рдирдореБрдирд╛ - рддреБрдореНрд╣реА рдпрд╛рдд рдЕрдзрд┐рдХ рдУрд│реА рдЬреЛрдбреВ рд╢рдХрддрд╛)
const cropData = {
    "KHARIF": {
        "rice": "рднрд╛рдд", "jowar_kh": "рдЬреНрд╡рд╛рд░реА", "bajra": "рдмрд╛рдЬрд░реА", "maize_kh": "рдордХрд╛", "ragi": "рдирд╛рдЪрдгреА", "tur": "рддреВрд░", 
        "moong_kh": "рдореВрдЧ", "urad_kh": "рдЙрдбреАрдж", "kulthi": "рдХреБрд▓рдереА", "cowpea": "рдЪрд╡рд│реА", "soybean": "рд╕реЛрдпрд╛рдмреАрди", 
        "groundnut_kh": "рднреБрдИрдореВрдЧ", "sunflower_kh": "рд╕реВрд░реНрдпрдлреВрд▓", "sesame": "рддреАрд│", "cotton": "рдХрд╛рдкреВрд╕", "sugarcane": "рдКрд╕"
        // ... (рдЕрд╢реА рдПрдХреВрдг ремреж рдЦрд░реАрдк рдкрд┐рдХреЗ)
    },
    "RABI": {
        "wheat": "рдЧрд╣реВ", "jowar_rabi": "рд░рдмреНрдмреА рдЬреНрд╡рд╛рд░реА", "gram": "рд╣рд░рднрд░рд╛", "pea": "рд╡рд╛рдЯрд╛рдгрд╛", "onion": "рдХрд╛рдВрджрд╛", 
        "garlic": "рд▓рд╕реВрдг", "potato": "рдмрдЯрд╛рдЯрд╛", "mustard": "рдореЛрд╣рд░реА", "safflower": "рдХрд░рдбрдИ"
        // ... (рдЕрд╢реА рдПрдХреВрдг рекреж рд░рдмреНрдмреА рдкрд┐рдХреЗ)
    },
    "SUMMER": {
        "watermelon": "рдХрд▓рд┐рдВрдЧрдб", "muskmelon": "рдЦрд░рдмреВрдЬ", "cucumber": "рдХрд╛рдХрдбреА", "okra": "рднреЗрдВрдбреА", "summer_moong": "рдЙрдиреНрд╣рд╛рд│реА рдореВрдЧ"
    },
    "OTHER": {
        "turmeric": "рд╣рд│рдж", "ginger": "рдЖрд▓реЗ", "chilli": "рдорд┐рд░рдЪреА", "coriander": "рдХреЛрдерд┐рдВрдмреАрд░", "napier": "рдиреЗрдкрд┐рдЕрд░ рдЧрд╡рдд"
    }
};

// рд╡рд┐рд╢рд┐рд╖реНрдЯ рджрд┐рд╡рд╕рд╛рдВрдЪреЗ рд╕рд▓реНрд▓реЗ
const advices = {
    "cotton": { 30: "ЁЯМ▒ рдЦрдд рджреНрдпрд╛.", 50: "тЪая╕П рдмреЛрдВрдбрдЕрд│реА рд╕рд╛рдкрд│реЗ рд▓рд╛рд╡рд╛.", 80: "ЁЯМ╕ рдлрд╡рд╛рд░рдгреА рдХрд░рд╛." },
    "soybean": { 20: "ЁЯМ┐ рддрдг рдирд┐рдпрдВрддреНрд░рдг.", 45: "ЁЯМ╕ рдлреБрд▓рдзрд╛рд░рдгрд╛ рдкрд╛рдгреА рджреНрдпрд╛.", 70: "ЁЯРЫ рдЕрд│реА рдирд┐рдпрдВрддреНрд░рдг." },
    "wheat": { 21: "ЁЯТз рдкрд╣рд┐рд▓реЗ рдкрд╛рдгреА (рдореБрдХреБрдЯрдореБрд│реЗ).", 45: "ЁЯМ╛ рдЦрдд рдорд╛рддреНрд░рд╛ рджреНрдпрд╛.", 80: "ЁЯМ╛ рджрд╛рдгреЗ рднрд░рддрд╛рдирд╛ рдкрд╛рдгреА." }
    // рдЕрд╢рд╛ рдкреНрд░рдХрд╛рд░реЗ рд╕рд░реНрд╡ резреиреж рдкрд┐рдХрд╛рдВрдЪреЗ рдореБрдЦреНрдп 'Day' рд╕рд▓реНрд▓реЗ рдЗрдереЗ рдпреЗрддреАрд▓.
};

function loadCrops() {
    const season = document.getElementById('seasonSelect').value;
    const cropSelect = document.getElementById('cropSelect');
    cropSelect.innerHTML = '<option value="">-- рдирд┐рд╡рдбрд╛ --</option>';
    if(cropData[season]) {
        for(let key in cropData[season]) {
            cropSelect.add(new Option(cropData[season][key], key));
        }
    }
}

function saveFarm() {
    const season = document.getElementById('seasonSelect').value;
    const crop = document.getElementById('cropSelect').value;
    const date = document.getElementById('plantDate').value;
    if(!date || !crop) { alert("рд╕рд░реНрд╡ рдорд╛рд╣рд┐рддреА рднрд░рд╛!"); return; }

    localStorage.setItem("myFarm", JSON.stringify({season, crop, date}));
    requestNotification(); // рдиреЛрдЯрд┐рдлрд┐рдХреЗрд╢рди рдкрд░рд╡рд╛рдирдЧреА рдорд╛рдЧрдгреЗ
    showAdvice();
}

function showAdvice() {
    const data = JSON.parse(localStorage.getItem("myFarm"));
    if(!data) return;

    document.getElementById("setupForm").style.display = "none";
    document.getElementById("adviceDisplay").style.display = "block";

    const diff = Math.floor((new Date() - new Date(data.date)) / (86400000));
    let msg = "ЁЯМ┐ рдкрд┐рдХрд╛рдЪреА рдХрд╛рд│рдЬреА рдШреНрдпрд╛ рдЖрдгрд┐ рд░реЛрдЬ рдирд┐рд░реАрдХреНрд╖рдг рдХрд░рд╛.";
    
    if(advices[data.crop] && advices[data.crop][diff]) {
        msg = advices[data.crop][diff];
        sendPushNotification(msg); // рдСрдЯреЛрдореЕрдЯрд┐рдХ рдиреЛрдЯрд┐рдлрд┐рдХреЗрд╢рди рдкрд╛рдард╡рдгреЗ
    }

    document.getElementById("adviceContent").innerHTML = `
        <h3 style="margin-top:0;">ЁЯЪй рдЖрдЬрдЪрд╛ рджрд┐рд╡рд╕: ${diff}</h3>
        <p><strong>рдкреАрдХ:</strong> ${cropData[data.season][data.crop]}</p>
        <p><strong>ЁЯУв рд╕рд▓реНрд▓рд╛:</strong> ${msg}</p>
    `;
}

function requestNotification() {
    if ("Notification" in window) {
        Notification.requestPermission();
    }
}

function sendPushNotification(text) {
    if ("Notification" in window && Notification.permission === "granted") {
        new Notification("рд╢реЗрддреА рд╕рд▓реНрд▓рд╛", { body: text, icon: "logo.png" });
    }
}

function resetData() {
    if(confirm("рдорд╛рд╣рд┐рддреА рдкреБрд╕рд╛рдпрдЪреА рдЖрд╣реЗ рдХрд╛?")) {
        localStorage.removeItem("myFarm");
        location.reload();
    }
}

window.onload = showAdvice;
</script>
</body>
</html>
