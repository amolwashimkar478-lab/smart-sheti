<!DOCTYPE html>
<html lang="mr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Smart Sheti - AI</title>

<style>
*{box-sizing:border-box;}
body{
  margin:0;background:#e8f5e9;font-family:Arial;height:100vh;display:flex;flex-direction:column;
}

/* HEADER */
header{
  background:#2e7d32;color:#fff;padding:14px;display:flex;align-items:center;
  font-size:18px;gap:12px;position:relative;z-index:20;
}
.menuBtn{font-size:22px;cursor:pointer;}

/* SIDE MENU */
#sideMenu{
  position:fixed;top:0;left:-260px;width:260px;height:100%;background:#ffffff;
  padding:14px;box-shadow:2px 0 8px rgba(0,0,0,0.2);transition:0.3s;z-index:15;
}
#sideMenu.show{left:0;}
.history-item{
  padding:10px;border-bottom:1px solid #ddd;cursor:pointer;
  display:flex;justify-content:space-between;align-items:center;
}

/* History Action Box */
.history-actions{
  position:fixed;bottom:30px;left:50%;transform:translateX(-50%);
  width:200px;background:#fff;border:1px solid #ccc;border-radius:10px;
  padding:10px;display:none;z-index:30;
}
.history-actions button{
  background:none;border:none;padding:8px;text-align:left;font-size:15px;width:100%;
}

/* DARK OVERLAY */
#overlay{
  position:fixed;top:0;left:0;width:100%;height:100%;
  background:rgba(0,0,0,0.45);display:none;z-index:10;
}

/* CHAT */
#chatBox{flex:1;padding:12px;overflow-y:auto;}
.user,.ai{
  max-width:85%;padding:10px 12px;margin:6px 0;border-radius:14px;font-size:15px;
}
.user{background:#c8e6c9;margin-left:auto;}
.ai{background:#fff;border:1px solid #ddd;}

/* INPUT BAR */
#inputBar{
  display:flex;gap:6px;padding:8px;background:#fff;border-top:1px solid #ccc;
}
#inputBar input{
  flex:1;padding:10px;border-radius:20px;border:1px solid #ccc;font-size:15px;
}
.iconBtn{
  background:#2e7d32;border:none;color:#fff;width:38px;height:38px;border-radius:50%;
}
.sendBtn{background:#1565c0;}
</style>
</head>

<body>

<header>
  <span class="menuBtn" onclick="toggleMenu()">‚ò∞</span>
  ü§ñ ‡§∂‡•á‡§§‡§ï‡§∞‡•Ä AI ‡§Æ‡§ø‡§§‡•ç‡§∞
</header>

<div id="overlay" onclick="closeMenu()"></div>

<!-- SIDE MENU -->
<div id="sideMenu">
  <h3>üìú ‡§Æ‡§æ‡§ù‡•Ä ‡§π‡§ø‡§∏‡•ç‡§ü‡•ç‡§∞‡•Ä</h3>
  <input id="searchHistory" placeholder="‡§ö‡•Ö‡§ü ‡§∂‡•ã‡§ß‡§æ..." style="width:100%;padding:8px;border:1px solid #ccc;border-radius:6px;">
  <div id="historyList"></div>
  <button onclick="clearAllHistory()" style="margin-top:15px;background:red;color:#fff;padding:10px;width:100%;border:none;border-radius:6px;">üóëÔ∏è ‡§∏‡§∞‡•ç‡§µ ‡§°‡§æ‡§ü‡§æ ‡§°‡§ø‡§≤‡§ø‡§ü</button>
</div>

<!-- CHAT -->
<div id="chatBox"></div>

<!-- INPUT BAR -->
<div id="inputBar">
  <button class="iconBtn" onclick="openCamera()">üì∑</button>
  <button class="iconBtn" onclick="openGallery()">üñºÔ∏è</button>
  <input id="userInput" placeholder="‡§™‡•ç‡§∞‡§∂‡•ç‡§® ‡§≤‡§ø‡§π‡§æ...">
  <button class="iconBtn sendBtn" onclick="sendMessage()">‚û§</button>

  <input type="file" id="cameraInput" accept="image/*" capture="environment" hidden>
  <input type="file" id="galleryInput" accept="image/*" hidden>
</div>

<script>
const chatBox=document.getElementById("chatBox");
const input=document.getElementById("userInput");
let history = JSON.parse(localStorage.getItem("chatHistory") || "[]");
renderHistory();

/* ---------------- MENU OPEN / CLOSE ---------------- */
function toggleMenu(){
  const menu=document.getElementById("sideMenu");
  const overlay=document.getElementById("overlay");
  menu.classList.toggle("show");
  overlay.style.display = menu.classList.contains("show") ? "block" : "none";
}
function closeMenu(){
  document.getElementById("sideMenu").classList.remove("show");
  document.getElementById("overlay").style.display="none";
}

/* ‡§∏‡•ç‡§ï‡•ç‡§∞‡•Ä‡§® ‡§µ‡§∞ ‡§ï‡•Å‡§†‡•á‡§π‡•Ä ‡§ï‡•ç‡§≤‡§ø‡§ï = ‡§Æ‡•á‡§®‡•Ç ‡§¨‡§Ç‡§¶ */
document.addEventListener("click",(e)=>{
  if(!document.getElementById("sideMenu").contains(e.target) &&
     !e.target.classList.contains("menuBtn")){
        closeMenu();
  }
});

/* ---------------- MESSAGE SEND ---------------- */
async function sendMessage(){
  const text = input.value.trim();
  if(!text) return;
  add(text,"user");
  saveHistory(text);
  input.value = "";

  try{
    const res = await fetch("/api/chat",{
      method:"POST",headers:{"Content-Type":"application/json"},
      body:JSON.stringify({prompt:text})
    });
    const data = await res.json();
    add(data.reply || "‡§â‡§§‡•ç‡§§‡§∞ ‡§Æ‡§ø‡§≥‡§§ ‡§®‡§æ‡§π‡•Ä","ai");
  } catch{
    add("‚ùå ‡§∏‡§∞‡•ç‡§µ‡•ç‡§π‡§∞‡§∂‡•Ä ‡§∏‡§Ç‡§™‡§∞‡•ç‡§ï ‡§®‡§æ‡§π‡•Ä","ai");
  }
}

function add(t,c){
  const d=document.createElement("div");d.className=c;d.innerText=t;
  chatBox.appendChild(d);chatBox.scrollTop=chatBox.scrollHeight;
}

/* ---------------- SAVE HISTORY ---------------- */
function saveHistory(text){
  history.unshift({txt:text,pin:false});
  localStorage.setItem("chatHistory",JSON.stringify(history));
  renderHistory();
}

function renderHistory(){
  const box=document.getElementById("historyList");
  box.innerHTML="";
  history.forEach((h,i)=>{
    box.innerHTML += `
      <div class="history-item" onclick="openOptions(${i})">
        ${h.pin ? "üìå" : "üí¨"} ${h.txt.slice(0,15)}...
      </div>`;
  });
}

/* ---------------- OPTIONS MENU ---------------- */
function openOptions(i){
  const menu=document.createElement("div");
  menu.className="history-actions";
  menu.style.display="block";
  menu.innerHTML=`
    <button onclick="pinChat(${i})">üìå ‡§™‡§ø‡§® ‡§ï‡§∞‡§æ</button>
    <button onclick="renameChat(${i})">‚úèÔ∏è ‡§®‡§æ‡§µ ‡§¨‡§¶‡§≤‡§æ</button>
    <button onclick="deleteChat(${i})">üóëÔ∏è ‡§π‡§ü‡§µ‡§æ</button>
  `;
  document.body.appendChild(menu);
  setTimeout(()=>document.addEventListener("click",()=>menu.remove(),{once:true}),10);
}

function pinChat(i){history[i].pin=true;save();}
function renameChat(i){let n=prompt("‡§®‡§µ‡•Ä‡§® ‡§®‡§æ‡§µ",history[i].txt);if(n){history[i].txt=n;save();}}
function deleteChat(i){history.splice(i,1);save();}
function clearAllHistory(){localStorage.removeItem("chatHistory");history=[];renderHistory();}

function save(){localStorage.setItem("chatHistory",JSON.stringify(history));renderHistory();}

/* CAMERA / GALLERY */
function openCamera(){document.getElementById("cameraInput").click();}
function openGallery(){document.getElementById("galleryInput").click();}
</script>

</body>
</html> html>
<html lang="mr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Smart Sheti - AI</title>

<style>
*{box-sizing:border-box;}
body{
  margin:0;background:#e8f5e9;font-family:Arial;height:100vh;display:flex;flex-direction:column;
}

/* HEADER */
header{
  background:#2e7d32;color:#fff;padding:14px;display:flex;align-items:center;
  font-size:18px;gap:12px;position:relative;z-index:20;
}
.menuBtn{font-size:22px;cursor:pointer;}

/* SIDE MENU */
#sideMenu{
  position:fixed;top:0;left:-260px;width:260px;height:100%;background:#ffffff;
  padding:14px;box-shadow:2px 0 8px rgba(0,0,0,0.2);transition:0.3s;z-index:15;
}
#sideMenu.show{left:0;}
.history-item{
  padding:10px;border-bottom:1px solid #ddd;cursor:pointer;
  display:flex;justify-content:space-between;align-items:center;
}

/* History Action Box */
.history-actions{
  position:fixed;bottom:30px;left:50%;transform:translateX(-50%);
  width:200px;background:#fff;border:1px solid #ccc;border-radius:10px;
  padding:10px;display:none;z-index:30;
}
.history-actions button{
  background:none;border:none;padding:8px;text-align:left;font-size:15px;width:100%;
}

/* DARK OVERLAY */
#overlay{
  position:fixed;top:0;left:0;width:100%;height:100%;
  background:rgba(0,0,0,0.45);display:none;z-index:10;
}

/* CHAT */
#chatBox{flex:1;padding:12px;overflow-y:auto;}
.user,.ai{
  max-width:85%;padding:10px 12px;margin:6px 0;border-radius:14px;font-size:15px;
}
.user{background:#c8e6c9;margin-left:auto;}
.ai{background:#fff;border:1px solid #ddd;}

/* INPUT BAR */
#inputBar{
  display:flex;gap:6px;padding:8px;background:#fff;border-top:1px solid #ccc;
}
#inputBar input{
  flex:1;padding:10px;border-radius:20px;border:1px solid #ccc;font-size:15px;
}
.iconBtn{
  background:#2e7d32;border:none;color:#fff;width:38px;height:38px;border-radius:50%;
}
.sendBtn{background:#1565c0;}
</style>
</head>

<body>

<header>
  <span class="menuBtn" onclick="toggleMenu()">‚ò∞</span>
  ü§ñ ‡§∂‡•á‡§§‡§ï‡§∞‡•Ä AI ‡§Æ‡§ø‡§§‡•ç‡§∞
</header>

<div id="overlay" onclick="closeMenu()"></div>

<!-- SIDE MENU -->
<div id="sideMenu">
  <h3>üìú ‡§Æ‡§æ‡§ù‡•Ä ‡§π‡§ø‡§∏‡•ç‡§ü‡•ç‡§∞‡•Ä</h3>
  <input id="searchHistory" placeholder="‡§ö‡•Ö‡§ü ‡§∂‡•ã‡§ß‡§æ..." style="width:100%;padding:8px;border:1px solid #ccc;border-radius:6px;">
  <div id="historyList"></div>
  <button onclick="clearAllHistory()" style="margin-top:15px;background:red;color:#fff;padding:10px;width:100%;border:none;border-radius:6px;">üóëÔ∏è ‡§∏‡§∞‡•ç‡§µ ‡§°‡§æ‡§ü‡§æ ‡§°‡§ø‡§≤‡§ø‡§ü</button>
</div>

<!-- CHAT -->
<div id="chatBox"></div>

<!-- INPUT BAR -->
<div id="inputBar">
  <button class="iconBtn" onclick="openCamera()">üì∑</button>
  <button class="iconBtn" onclick="openGallery()">üñºÔ∏è</button>
  <input id="userInput" placeholder="‡§™‡•ç‡§∞‡§∂‡•ç‡§® ‡§≤‡§ø‡§π‡§æ...">
  <button class="iconBtn sendBtn" onclick="sendMessage()">‚û§</button>

  <input type="file" id="cameraInput" accept="image/*" capture="environment" hidden>
  <input type="file" id="galleryInput" accept="image/*" hidden>
</div>

<script>
const chatBox=document.getElementById("chatBox");
const input=document.getElementById("userInput");
let history = JSON.parse(localStorage.getItem("chatHistory") || "[]");
renderHistory();

/* ---------------- MENU OPEN / CLOSE ---------------- */
function toggleMenu(){
  const menu=document.getElementById("sideMenu");
  const overlay=document.getElementById("overlay");
  menu.classList.toggle("show");
  overlay.style.display = menu.classList.contains("show") ? "block" : "none";
}
function closeMenu(){
  document.getElementById("sideMenu").classList.remove("show");
  document.getElementById("overlay").style.display="none";
}

/* ‡§∏‡•ç‡§ï‡•ç‡§∞‡•Ä‡§® ‡§µ‡§∞ ‡§ï‡•Å‡§†‡•á‡§π‡•Ä ‡§ï‡•ç‡§≤‡§ø‡§ï = ‡§Æ‡•á‡§®‡•Ç ‡§¨‡§Ç‡§¶ */
document.addEventListener("click",(e)=>{
  if(!document.getElementById("sideMenu").contains(e.target) &&
     !e.target.classList.contains("menuBtn")){
        closeMenu();
  }
});

/* ---------------- MESSAGE SEND ---------------- */
async function sendMessage(){
  const text = input.value.trim();
  if(!text) return;
  add(text,"user");
  saveHistory(text);
  input.value = "";

  try{
    const res = await fetch("/api/chat",{
      method:"POST",headers:{"Content-Type":"application/json"},
      body:JSON.stringify({prompt:text})
    });
    const data = await res.json();
    add(data.reply || "‡§â‡§§‡•ç‡§§‡§∞ ‡§Æ‡§ø‡§≥‡§§ ‡§®‡§æ‡§π‡•Ä","ai");
  } catch{
    add("‚ùå ‡§∏‡§∞‡•ç‡§µ‡•ç‡§π‡§∞‡§∂‡•Ä ‡§∏‡§Ç‡§™‡§∞‡•ç‡§ï ‡§®‡§æ‡§π‡•Ä","ai");
  }
}

function add(t,c){
  const d=document.createElement("div");d.className=c;d.innerText=t;
  chatBox.appendChild(d);chatBox.scrollTop=chatBox.scrollHeight;
}

/* ---------------- SAVE HISTORY ---------------- */
function saveHistory(text){
  history.unshift({txt:text,pin:false});
  localStorage.setItem("chatHistory",JSON.stringify(history));
  renderHistory();
}

function renderHistory(){
  const box=document.getElementById("historyList");
  box.innerHTML="";
  history.forEach((h,i)=>{
    box.innerHTML += `
      <div class="history-item" onclick="openOptions(${i})">
        ${h.pin ? "üìå" : "üí¨"} ${h.txt.slice(0,15)}...
      </div>`;
  });
}

/* ---------------- OPTIONS MENU ---------------- */
function openOptions(i){
  const menu=document.createElement("div");
  menu.className="history-actions";
  menu.style.display="block";
  menu.innerHTML=`
    <button onclick="pinChat(${i})">üìå ‡§™‡§ø‡§® ‡§ï‡§∞‡§æ</button>
    <button onclick="renameChat(${i})">‚úèÔ∏è ‡§®‡§æ‡§µ ‡§¨‡§¶‡§≤‡§æ</button>
    <button onclick="deleteChat(${i})">üóëÔ∏è ‡§π‡§ü‡§µ‡§æ</button>
  `;
  document.body.appendChild(menu);
  setTimeout(()=>document.addEventListener("click",()=>menu.remove(),{once:true}),10);
}

function pinChat(i){history[i].pin=true;save();}
function renameChat(i){let n=prompt("‡§®‡§µ‡•Ä‡§® ‡§®‡§æ‡§µ",history[i].txt);if(n){history[i].txt=n;save();}}
function deleteChat(i){history.splice(i,1);save();}
function clearAllHistory(){localStorage.removeItem("chatHistory");history=[];renderHistory();}

function save(){localStorage.setItem("chatHistory",JSON.stringify(history));renderHistory();}

/* CAMERA / GALLERY */
function openCamera(){document.getElementById("cameraInput").click();}
function openGallery(){document.getElementById("galleryInput").click();}
</script>

</body>
</html>
