<!DOCTYPE html>
<html lang="mr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Smart Sheti - AI</title>

<style>
*{box-sizing:border-box;}
body{margin:0;background:#e8f5e9;font-family:Arial;height:100vh;display:flex;flex-direction:column;}

/* HEADER */
header{
  background:#2e7d32;color:#fff;padding:14px;display:flex;align-items:center;
  font-size:18px;gap:12px;z-index:20;position:relative;
}
.menuBtn{font-size:22px;cursor:pointer;}

/* SIDE MENU */
#sideMenu{
  position:fixed;top:0;left:-260px;width:260px;height:100%;background:white;
  padding:14px;box-shadow:3px 0 10px rgba(0,0,0,0.3);transition:0.3s;overflow-y:auto;z-index:15;
}
#sideMenu.show{left:0;}

.history-item{
  padding:10px;border-bottom:1px solid #ddd;cursor:pointer;
  font-size:15px;display:flex;justify-content:space-between;align-items:center;
  user-select:none;
}

/* LONG PRESS OPTIONS */
#optionMenu{
  position:fixed;bottom:50px;left:50%;transform:translateX(-50%);
  width:200px;background:white;border-radius:10px;display:none;
  box-shadow:0 4px 12px rgba(0,0,0,0.25);overflow:hidden;z-index:99;
}
#optionMenu button{
  width:100%;padding:12px;border:none;background:none;text-align:left;
  border-bottom:1px solid #eee;font-size:15px;cursor:pointer;
}

/* OVERLAY */
#overlay{
  position:fixed;top:0;left:0;width:100%;height:100%;
  background:rgba(0,0,0,0.4);display:none;z-index:10;
}

/* CHAT */
#chatBox{flex:1;padding:12px;overflow-y:auto;display:flex;flex-direction:column;}
.user,.ai{
  max-width:85%;padding:10px;margin:6px 0;border-radius:14px;font-size:15px;
}
.user{background:#c8e6c9;align-self:flex-end;}
.ai{background:white;border:1px solid #ddd;align-self:flex-start;}

.chat-img{max-width:100%;border-radius:8px;margin-top:6px;}

/* INPUT BAR */
#inputBar{display:flex;gap:6px;padding:8px;background:#fff;border-top:1px solid #ccc;}
#inputBar input{flex:1;padding:10px;border-radius:20px;border:1px solid #ccc;}

.iconBtn{background:#2e7d32;border:none;color:#fff;width:40px;height:40px;border-radius:50%;cursor:pointer;}
.sendBtn{background:#1565c0;}
</style>
</head>

<body>

<header>
  <span class="menuBtn" onclick="toggleMenu()">‚ò∞</span>
  ü§ñ ‡§∂‡•á‡§§‡§ï‡§∞‡•Ä AI ‡§Æ‡§ø‡§§‡•ç‡§∞
</header>

<div id="overlay" onclick="closeMenu();closeOptions();"></div>

<div id="sideMenu">
  <h3>üìú ‡§Æ‡§æ‡§ù‡•Ä ‡§π‡§ø‡§∏‡•ç‡§ü‡•ç‡§∞‡•Ä</h3>
  <input id="searchHistory" oninput="filterHistory()" placeholder="‡§ö‡•Ö‡§ü ‡§∂‡•ã‡§ß‡§æ..." style="width:100%;padding:8px;border:1px solid #ccc;border-radius:6px;margin-bottom:10px;">
  <div id="historyList"></div>
  <button onclick="clearAllHistory()" style="margin-top:15px;background:#d32f2f;color:#fff;padding:10px;width:100%;border:none;border-radius:6px;">üóëÔ∏è ‡§∏‡§∞‡•ç‡§µ ‡§°‡§æ‡§ü‡§æ ‡§°‡§ø‡§≤‡§ø‡§ü</button>
</div>

<div id="chatBox"></div>

<div id="inputBar">
  <input id="userInput" placeholder="‡§™‡•ç‡§∞‡§∂‡•ç‡§® ‡§≤‡§ø‡§π‡§æ...">
  <button class="iconBtn sendBtn" onclick="sendMessage()">‚û§</button>
</div>

<!-- LONG PRESS MENU -->
<div id="optionMenu">
  <button id="openBtn">üìÇ ‡§ö‡•Ö‡§ü ‡§â‡§ò‡§°‡§æ</button>
  <button id="pinBtn">üìå ‡§™‡§ø‡§® ‡§ï‡§∞‡§æ</button>
  <button id="renameBtn">‚úèÔ∏è ‡§®‡§æ‡§µ ‡§¨‡§¶‡§≤‡§æ</button>
  <button id="deleteBtn">üóëÔ∏è ‡§π‡§ü‡§µ‡§æ</button>
</div>

<script>
const chatBox = document.getElementById("chatBox");
let history = JSON.parse(localStorage.getItem("chatHistory") || "[]");
let longPressIndex = null;

/* ---------------- MENU ---------------- */
function toggleMenu(){
  const m=document.getElementById("sideMenu");
  const o=document.getElementById("overlay");
  m.classList.toggle("show");
  o.style.display = m.classList.contains("show") ? "block" : "none";
  renderHistory();
}
function closeMenu(){
  document.getElementById("sideMenu").classList.remove("show");
  document.getElementById("overlay").style.display="none";
}

/* ---------------- CHAT ---------------- */
function sendMessage(){
  const text = userInput.value.trim();
  if(!text) return;
  add(text,"user");
  saveHistory(text);
  userInput.value="";
}
function add(t,c){
  const d=document.createElement("div");
  d.className=c; d.innerText=t;
  chatBox.appendChild(d);
  chatBox.scrollTop=chatBox.scrollHeight;
}

/* ---------------- HISTORY ---------------- */
function saveHistory(text){
  history.unshift({txt:text,pin:false,data:[{sender:"user",text:text}]});
  updateHistory();
}
function renderHistory(list=history){
  const box=document.getElementById("historyList");
  box.innerHTML="";
  list.forEach((h,i)=>{
    box.innerHTML+=`
      <div class="history-item"
        onclick="openChat(${i})"
        oncontextmenu="event.preventDefault();showOptions(${i})"
        ontouchstart="startPress(${i})"
        ontouchend="cancelPress()"
      >
        <span>${h.pin?"üìå":"üí¨"} ${h.txt.slice(0,18)}...</span>
      </div>`;
  });
}
function openChat(i){
  chatBox.innerHTML="";
  history[i].data.forEach(msg=> add(msg.text,msg.sender));
  closeMenu();
}
function startPress(i){
  pressTimer = setTimeout(()=>showOptions(i),600);
}
function cancelPress(){
  clearTimeout(pressTimer);
}

/* ---------------- LONG PRESS OPTIONS ---------------- */
function showOptions(i){
  longPressIndex=i;
  const m=document.getElementById("optionMenu");
  m.style.display="block";
  document.getElementById("overlay").style.display="block";

  document.getElementById("openBtn").onclick=()=>{openChat(i);closeOptions();}
  document.getElementById("pinBtn").onclick=()=>{history[i].pin=!history[i].pin;updateHistory();}
  document.getElementById("renameBtn").onclick=()=>{let n=prompt("‡§®‡§µ‡•Ä‡§® ‡§®‡§æ‡§µ:",history[i].txt);if(n){history[i].txt=n;updateHistory();}}
  document.getElementById("deleteBtn").onclick=()=>{history.splice(i,1);updateHistory();closeOptions();}
}
function closeOptions(){ document.getElementById("optionMenu").style.display="none"; }

function updateHistory(){
  localStorage.setItem("chatHistory",JSON.stringify(history));
  renderHistory();closeOptions();
}
function filterHistory(){
  let k=searchHistory.value.toLowerCase();
  renderHistory(history.filter(h=>h.txt.toLowerCase().includes(k)));
}
function clearAllHistory(){
  if(confirm("‡§∏‡§∞‡•ç‡§µ ‡§π‡§ü‡§µ‡§æ‡§Ø‡§ö‡•á?")){localStorage.removeItem("chatHistory");history=[];renderHistory();}
}

renderHistory();
</script>
</body>
</html>
