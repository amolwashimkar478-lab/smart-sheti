<!DOCTYPE html>
<html lang="mr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Smart Sheti - Home</title>

<style>
body{
  font-family: 'Segoe UI', Arial, sans-serif;
  background:#e8f5e9;
  display:flex;
  flex-direction:column;
  align-items:center;
  padding:20px;
}

.logo{
  font-size:28px;
  font-weight:bold;
  color:#2e7d32;
  margin-bottom:25px;
}

/* Common button */
.btn{
  width:100%;
  max-width:300px;
  padding:14px 16px;
  margin:10px 0;
  font-size:17px;
  border:none;
  border-radius:12px;
  cursor:pointer;
  display:flex;
  align-items:center;
  justify-content:center;
  gap:8px;
  color:white;
  box-shadow:0 4px 8px rgba(0,0,0,0.12);
  transition: 0.3s;
}

.btn:active { transform: scale(0.98); }

/* Weather & Spray */
.weather-btn{ background:#1565c0; }
.spray-btn { background:#00796b; } /* рдирд╡реАрди рдлрд╡рд╛рд░рдгреА рдмрдЯрдирд╕рд╛рдареА рд░рдВрдЧ */

/* AI & Tools */
.ai-btn{ background:#2e7d32; }

/* Notification & News */
.notify-btn{ background:#ef6c00; }
  
  /* Market рдмрдЯрди рдЙрдареВрди рджрд┐рд╕рдгреНрдпрд╛рд╕рд╛рдареА */
.market-btn {
    background-color: #2e7d32 !important; /* рд╣рд┐рд░рд╡рд╛ рд░рдВрдЧ */
    color: white !important;
    opacity: 1 !important;
}
  
</style>
</head>

<body>

<div class="logo">ЁЯМ╛ Smart Sheti</div>

<button class="btn weather-btn" onclick="goToWeather()">
  ЁЯМж рдЖрдЬрдЪрдВ рд╣рд╡рд╛рдорд╛рди
</button>

<button class="btn spray-btn" onclick="checkWeatherForSpray()">
  ЁЯЪ┐ рдлрд╡рд╛рд░рдгреА рд╕рд▓реНрд▓рд╛ (рдкрд╛рдКрд╕ рдЪреЗрдХ рдХрд░рд╛)
</button>

<button class="btn ai-btn" onclick="location.href='ai.html'">
  ЁЯдЦ AI рд╕рд▓реНрд▓рд╛
</button>

<button class="btn ai-btn" onclick="location.href='disease.html'">
  ЁЯУ╕ рд░реЛрдЧ рдУрд│рдЦ (рдлреЛрдЯреЛ)
</button>

<button class="btn ai-btn" onclick="location.href='crop-calendar.html'">
  ЁЯМ▒ Crop Calendar
</button>

<button class="btn notify-btn" onclick="location.href='news.html'">
  ЁЯУ░ рд╢реЗрддреА рдмрд╛рддрдореНрдпрд╛
</button>

<button class="btn notify-btn" onclick="enableNotification()">
  ЁЯФФ рдкрд╛рд╡рд╕рд╛рдЪрд╛ Alert ON
</button>

<button class="btn market-btn" onclick="location.href='market.html'">
  <span class="icon">ЁЯУИ</span> Market (рдмрд╛рдЬрд╛рд░рднрд╛рд╡)
</button>

  <button onclick="location.href='calculator.html'" style="width: 100%; padding: 18px; margin-bottom: 15px; border: none; border-radius: 15px; background: linear-gradient(135deg, #2e7d32, #43a047); color: white; font-size: 18px; font-weight: bold; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 10px; box-shadow: 0 4px 10px rgba(0,0,0,0.1);">
    ЁЯзк рдЦрдд рдХреЕрд▓реНрдХреНрдпреБрд▓реЗрдЯрд░ (A-Z)
  </button>

   <button onclick="location.href='spray-schedule.html'" style="width: 100%; padding: 18px; margin-bottom: 15px; border: none; border-radius: 15px; background: linear-gradient(135deg, #ef6c00, #fb8c00); color: white; font-size: 18px; font-weight: bold; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 10px; box-shadow: 0 4px 10px rgba(0,0,0,0.1);">
    ЁЯЪЬ рдлрд╡рд╛рд░рдгреА рд╡реЗрд│рд╛рдкрддреНрд░рдХ (A-Z)
   </button>
  
<script>
function goToWeather(){
  window.location.href = "weather.html";
}

// --- ЁЯМзя╕П рдлрд╡рд╛рд░рдгреА рдЖрдгрд┐ рд╣рд╡рд╛рдорд╛рди рд╕рд▓реНрд▓рд╛ (рддреБрдордЪрд╛ рдХреЛрдб рдЗрдереЗ рдЬреЛрдбрд▓рд╛ рдЖрд╣реЗ) ---
function checkWeatherForSpray() {
  if (!navigator.geolocation) {
    alert("рддреБрдордЪреНрдпрд╛ рдмреНрд░рд╛рдЙрдЭрд░рдордзреНрдпреЗ рд▓реЛрдХреЗрд╢рди рд╕рдкреЛрд░реНрдЯ рдирд╛рд╣реА.");
    return;
  }

  alert("рд╣рд╡рд╛рдорд╛рди рддрдкрд╛рд╕рдд рдЖрд╣реЗ, рдХреГрдкрдпрд╛ рдереЛрдбрд╛ рд╡реЗрд│ рдерд╛рдВрдмрд╛...");

  navigator.geolocation.getCurrentPosition(async (pos) => {
    const { latitude, longitude } = pos.coords;

    try {
      // рддреБрдордЪреНрдпрд╛ рдмреЕрдХрдПрдВрдб API рд▓рд╛ рдХреЙрд▓ (pages/api/weather.js)
      const res = await fetch(`/api/weather?lat=${latitude}&lon=${longitude}`);
      const data = await res.json();

      if (data.isRaining) {
        alert("ЁЯМзя╕П рдкрд╛рдКрд╕ рд╕реБрд░реВ рдЖрд╣реЗ рдХрд┐рдВрд╡рд╛ рдкрд╛рд╡рд╕рд╛рдЪреА рд╢рдХреНрдпрддрд╛ рдЖрд╣реЗ. рдлрд╡рд╛рд░рдгреА рдкреБрдвреЗ рдврдХрд▓рд╛! тЭМ");
      } else {
        alert("тЬЕ рд╕рдзреНрдпрд╛ рд╣рд╡рд╛рдорд╛рди рд╕рд╛рдл рдЖрд╣реЗ. рддреБрдореНрд╣реА рдлрд╡рд╛рд░рдгреАрдЪреЗ рдирд┐рдпреЛрдЬрди рдХрд░реВ рд╢рдХрддрд╛. ЁЯМ┐");
      }
    } catch (err) {
      console.error("Error:", err);
      alert("рд╣рд╡рд╛рдорд╛рди рдорд╛рд╣рд┐рддреА рдорд┐рд│рд╡рдгреНрдпрд╛рдд рдЕрдбрдЪрдг рдЖрд▓реА. рдХреГрдкрдпрд╛ рддреБрдордЪреА API Key рддрдкрд╛рд╕рд╛.");
    }
  }, (error) => {
    alert("рд▓реЛрдХреЗрд╢рди ре▓рдХреНрд╕реЗрд╕ рдирд╛рдХрд╛рд░рд▓рд╛. рдХреГрдкрдпрд╛ GPS рдЪрд╛рд▓реВ рдХрд░рд╛.");
  });
}

// ЁЯФФ Notification Permission
function enableNotification(){
  if(!("Notification" in window)){
    alert("рддреБрдордЪреНрдпрд╛ browser рдордзреНрдпреЗ notification support рдирд╛рд╣реА");
    return;
  }

  Notification.requestPermission().then(permission=>{
    if(permission === "granted"){
      alert("тЬЕ рдкрд╛рд╡рд╕рд╛рдЪрд╛ alert рдЪрд╛рд▓реВ рдЭрд╛рд▓рд╛");
      new Notification("ЁЯМзя╕П Smart Sheti", {
        body: "рдкрд╛рд╡рд╕рд╛рдЪрд╛ alert рдЪрд╛рд▓реВ рдЖрд╣реЗ. рдкрд╛рдКрд╕ рдЖрд▓реНрдпрд╛рд╕ рд╕реВрдЪрдирд╛ рдорд┐рд│реЗрд▓ ЁЯМ╛"
      });
    }else{
      alert("тЭМ Notification рдкрд░рд╡рд╛рдирдЧреА рдирд╛рдХрд╛рд░рд▓реА");
    }
  });
}

// ЁЯУ░ District-based daily news notification
async function checkDailyNews(district){
  try{
    const res = await fetch(`/api/news?district=${district}`);
    const data = await res.json();
    if(data.articles && data.articles.length > 0){
      const article = data.articles[0];
      if(Notification.permission === "granted"){
        new Notification(`ЁЯУ░ ${district} рд╢реЗрддреА рдмрд╛рддрдореНрдпрд╛`, {
          body: article.title,
        }).onclick = () => window.open(article.url, "_blank");
      }
    }
  } catch(err){
    console.error("News fetch error:", err);
  }
}

// ЁЯМЮ Auto-run on page load
window.onload = () => {
  const userDistrict = "Maharashtra"; 
  if(Notification.permission === "granted") {
    checkDailyNews(userDistrict);
  }
};
</script>

</body>
</html>
