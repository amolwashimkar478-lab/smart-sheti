<!DOCTYPE html>
<html lang="mr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>‡§´‡•ã‡§ü‡•ã‡§∏‡§π ‡§∂‡•á‡§§‡•Ä ‡§¨‡§æ‡§§‡§Æ‡•ç‡§Ø‡§æ</title>
  <style>
    :root { --orange: #e67e22; --bg: #f4f7f6; }
    body { font-family: 'Segoe UI', sans-serif; margin: 0; background: var(--bg); color: #333; }
    header { background: var(--orange); color: white; padding: 15px; text-align: center; font-size: 20px; font-weight: bold; position: sticky; top: 0; z-index: 100; }
    
    .news-container { padding: 15px; max-width: 600px; margin: auto; }
    
    .news-card { 
      background: #fff; border-radius: 15px; overflow: hidden; margin-bottom: 20px; 
      box-shadow: 0 4px 12px rgba(0,0,0,0.08); position: relative;
    }
    
    .news-img { width: 100%; height: 200px; object-fit: cover; background: #ddd; }
    
    .news-content { padding: 15px; }
    .news-content h3 { margin: 0 0 10px; font-size: 17px; line-height: 1.4; color: #111; }
    .news-content p { font-size: 14px; color: #666; margin-bottom: 12px; }
    
    .card-footer { display: flex; justify-content: space-between; align-items: center; border-top: 1px solid #eee; padding-top: 10px; }
    .read-more { color: var(--orange); text-decoration: none; font-weight: bold; font-size: 14px; }
    
    .save-btn { 
      background: rgba(255,255,255,0.9); border: none; font-size: 20px; cursor: pointer; 
      position: absolute; top: 10px; right: 10px; border-radius: 50%; width: 35px; height: 35px;
      display: flex; align-items: center; justify-content: center; box-shadow: 0 2px 5px rgba(0,0,0,0.2);
    }
    .saved { color: var(--orange); }

    .tabs { display: flex; background: white; position: sticky; top: 55px; z-index: 90; box-shadow: 0 2px 5px rgba(0,0,0,0.05); }
    .tab { flex: 1; text-align: center; padding: 12px; cursor: pointer; font-weight: bold; color: #888; border-bottom: 3px solid transparent; }
    .active-tab { color: var(--orange); border-bottom-color: var(--orange); }

    #loader { text-align: center; padding: 50px; color: var(--orange); }
  </style>
</head>
<body>

<header>üì∞ ‡§∂‡•á‡§§‡•Ä ‡§¨‡§æ‡§§‡§Æ‡•ç‡§Ø‡§æ</header>

<div class="tabs">
  <div id="latestTab" class="tab active-tab" onclick="showLatest()">‡§§‡§æ‡§ú‡•ç‡§Ø‡§æ ‡§¨‡§æ‡§§‡§Æ‡•ç‡§Ø‡§æ</div>
  <div id="savedTab" class="tab" onclick="showSaved()">‡§∏‡•á‡§µ‡•ç‡§π ‡§ï‡•á‡§≤‡•á‡§≤‡•ç‡§Ø‡§æ</div>
</div>

<div class="news-container" id="newsBox">
  <div id="loader">üîÑ ‡§¨‡§æ‡§§‡§Æ‡•ç‡§Ø‡§æ ‡§Ü‡§£‡§ø ‡§´‡•ã‡§ü‡•ã ‡§≤‡•ã‡§° ‡§π‡•ã‡§§ ‡§Ü‡§π‡•á‡§§...</div>
</div>

<div style="padding: 20px; text-align: center;">
  <button onclick="location.href='home.html'" style="width:100%; padding:14px; border-radius:12px; border:none; background:#eee; font-weight:bold; cursor:pointer;">‚Üê ‡§π‡•ã‡§Æ‡§µ‡§∞ ‡§™‡§∞‡§§ ‡§ú‡§æ</button>
</div>

<script>
let allNews = [];
let savedNews = JSON.parse(localStorage.getItem('agri_saved_news')) || [];

async function fetchAgriNews() {
  try {
    // Google News RSS feed for Agriculture in Marathi
    const rssUrl = 'https://news.google.com/rss/search?q=Maharashtra+Agriculture+Marathi&hl=mr&gl=IN&ceid=IN:mr';
    const response = await fetch(`https://api.rss2json.com/v1/api.json?rss_url=${encodeURIComponent(rssUrl)}`);
    const data = await response.json();
    
    allNews = data.items.map(item => {
      // ‡§¨‡§æ‡§§‡§Æ‡•Ä‡§Æ‡§ß‡•Ä‡§≤ ‡§´‡•ã‡§ü‡•ã ‡§∂‡•ã‡§ß‡§£‡•ç‡§Ø‡§æ‡§ö‡§æ ‡§™‡•ç‡§∞‡§Ø‡§§‡•ç‡§® (Description ‡§Æ‡§ß‡•Ç‡§®)
      let img = "https://via.placeholder.com/400x200?text=Agri+News";
      const div = document.createElement('div');
      div.innerHTML = item.description;
      const imgTag = div.querySelector('img');
      if (imgTag) img = imgTag.src;
      
      return { ...item, thumbnail: img };
    });
    
    showLatest();
  } catch (err) {
    document.getElementById('newsBox').innerHTML = "‚ùå ‡§¨‡§æ‡§§‡§Æ‡•ç‡§Ø‡§æ ‡§≤‡•ã‡§° ‡§π‡•ã‡§ä ‡§∂‡§ï‡§≤‡•ç‡§Ø‡§æ ‡§®‡§æ‡§π‡•Ä‡§§. ‡§á‡§Ç‡§ü‡§∞‡§®‡•á‡§ü ‡§§‡§™‡§æ‡§∏‡§æ.";
  }
}

function renderNews(items) {
  const box = document.getElementById('newsBox');
  box.innerHTML = "";
  
  items.forEach((news) => {
    const isSaved = savedNews.some(s => s.link === news.link);
    box.innerHTML += `
      <div class="news-card">
        <img src="${news.thumbnail}" class="news-img" onerror="this.src='https://via.placeholder.com/400x200?text=Smart+Sheti'">
        <button class="save-btn" onclick="toggleSave(${JSON.stringify(news).replace(/"/g, '&quot;')})">
          ${isSaved ? 'üîñ' : 'üìë'}
        </button>
        <div class="news-content">
          <h3>${news.title}</h3>
          <div class="card-footer">
            <small>üìÖ ${new Date(news.pubDate).toLocaleDateString('mr-IN')}</small>
            <a href="${news.link}" target="_blank" class="read-more">‡§™‡•Ç‡§∞‡•ç‡§£ ‡§¨‡§æ‡§§‡§Æ‡•Ä ‡§µ‡§æ‡§ö‡§æ ‚Üí</a>
          </div>
        </div>
      </div>
    `;
  });
}

function toggleSave(news) {
  const index = savedNews.findIndex(s => s.link === news.link);
  if (index > -1) {
    savedNews.splice(index, 1);
  } else {
    savedNews.unshift(news);
  }
  localStorage.setItem('agri_saved_news', JSON.stringify(savedNews));
  
  if (document.getElementById('savedTab').classList.contains('active-tab')) {
    showSaved();
  } else {
    showLatest();
  }
}

function showLatest() {
  document.getElementById('latestTab').classList.add('active-tab');
  document.getElementById('savedTab').classList.remove('active-tab');
  renderNews(allNews);
}

function showSaved() {
  document.getElementById('savedTab').classList.add('active-tab');
  document.getElementById('latestTab').classList.remove('active-tab');
  if (savedNews.length === 0) {
    document.getElementById('newsBox').innerHTML = "<p style='text-align:center; margin-top:50px;'>‡§§‡•Å‡§Æ‡•ç‡§π‡•Ä ‡§Ö‡§ú‡•Ç‡§® ‡§è‡§ï‡§π‡•Ä ‡§¨‡§æ‡§§‡§Æ‡•Ä ‡§∏‡•á‡§µ‡•ç‡§π ‡§ï‡•á‡§≤‡•á‡§≤‡•Ä ‡§®‡§æ‡§π‡•Ä.</p>";
  } else {
    renderNews(savedNews);
  }
}

fetchAgriNews();
</script>
</body>
</html>
