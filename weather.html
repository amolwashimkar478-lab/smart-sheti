<!DOCTYPE html>
<html lang="mr">
<head>
<meta charset="UTF-8">
<title>Smart Sheti | Weather</title>

<style>
body{
  margin:0;
  font-family: Arial, sans-serif;
  background:#e8f5e9;
  display:flex;
  flex-direction:column;
  align-items:center;
  padding:20px;
}

h2{
  color:#1b5e20;
  font-size:26px;
  margin-bottom:10px;
}

button{
  background:#2e7d32;
  color:#fff;
  border:none;
  padding:14px 20px;
  border-radius:10px;
  font-size:18px;
  cursor:pointer;
  margin:8px 0;
  width:90%;
  max-width:400px;
}

button:hover{
  background:#1b5e20;
}

.card{
  background:#fff;
  width:90%;
  max-width:400px;
  padding:15px;
  border-radius:12px;
  margin:10px 0;
  box-shadow:0 2px 5px rgba(0,0,0,0.1);
}

#rainAlert{
  display:none;
  background:#ffeb3b;
  color:#000;
  padding:15px;
  border-radius:10px;
  font-weight:bold;
  margin:10px 0;
  text-align:center;
}

.forecast{
  display:flex;
  justify-content:space-between;
  margin-top:8px;
  font-size:14px;
}
</style>
</head>

<body>

<h2>ЁЯМж рдЖрдЬрдЪрдВ рд╣рд╡рд╛рдорд╛рди</h2>

<button onclick="getWeather()">ЁЯУН рдорд╛рдЭреНрдпрд╛ рдард┐рдХрд╛рдгрдЪрдВ рд╣рд╡рд╛рдорд╛рди</button>

<div id="rainAlert">ЁЯМз рдкрд╛рдКрд╕ рдкрдбрдгреНрдпрд╛рдЪреА рд╢рдХреНрдпрддрд╛ рдЖрд╣реЗ тАУ рдХрд╛рд│рдЬреА рдШреНрдпрд╛!</div>

<div id="today" class="card"></div>

<div id="forecast" class="card"></div>

<button onclick="goBack()">тмЕ AI рдкреЗрдЬрд╡рд░ рдкрд░рдд рдЬрд╛</button>

<script>
const API_KEY = "f24d69cb16d56c33b2bb58ff57f3ea6e";

function goBack(){
  window.location.href = "home.html";
}

function speakMarathi(text){
  const msg = new SpeechSynthesisUtterance(text);
  msg.lang = "mr-IN";
  msg.rate = 0.9;
  speechSynthesis.speak(msg);
}

function getWeather(){
  if(!navigator.geolocation){
    alert("Location support рдирд╛рд╣реА");
    return;
  }

  navigator.geolocation.getCurrentPosition(pos=>{
    const lat = pos.coords.latitude;
    const lon = pos.coords.longitude;

    fetch(`https://api.openweathermap.org/data/2.5/forecast?lat=${lat}&lon=${lon}&appid=${API_KEY}&units=metric&lang=mr`)
      .then(res=>res.json())
      .then(data=>{
        showWeather(data);
      })
      .catch(()=>{
        alert("Weather рдорд┐рд│рд╛рд▓рдВ рдирд╛рд╣реА");
      });
  });
}

function showWeather(data){
  const today = data.list[0];
  const desc = today.weather[0].description;
  const temp = today.main.temp;

  document.getElementById("today").innerHTML = `
    <h3>ЁЯМд рдЖрдЬ</h3>
    <p>рд╣рд╡рд╛рдорд╛рди: ${desc}</p>
    <p>рддрд╛рдкрдорд╛рди: ${temp} ┬░C</p>
  `;

  // Rain alert
  if(desc.includes("рдкрд╛рдКрд╕")){
    document.getElementById("rainAlert").style.display = "block";
  }

  // Marathi voice
  speakMarathi(`рдЖрдЬрдЪрдВ рд╣рд╡рд╛рдорд╛рди рдЖрд╣реЗ ${desc}. рддрд╛рдкрдорд╛рди рдЖрд╣реЗ ${temp} рдЕрдВрд╢ рд╕реЗрд▓реНрд╕рд┐рдЕрд╕.`);

  // 5 day forecast
  let html = "<h3>ЁЯУЕ рдкреБрдвреАрд▓ 5 рджрд┐рд╡рд╕</h3>";

  for(let i=8;i<data.list.length;i+=8){
    const day = data.list[i];
    html += `
      <div class="forecast">
        <span>${new Date(day.dt_txt).toLocaleDateString("mr-IN")}</span>
        <span>${day.weather[0].description}</span>
        <span>${day.main.temp}┬░C</span>
      </div>
    `;
  }

  document.getElementById("forecast").innerHTML = html;
}
</script>

</body>
</html>
